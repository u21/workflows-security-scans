name: Security-Scans

on: 
  workflow_call:
    secrets:
      GITGUARDIAN:
        required: false
        
env :
  GITGUARDIAN_API_KEY: ${{ secrets.GITGUARDIAN }}
  VERACODE_API_ID: ${{ secrets.VERACODE_API_ID }}
  VERACODE_API_KEY: ${{ secrets.VERACODE_API_KEY }}

jobs :
  veracode :
    runs-on : ubuntu-latest
    steps :
      - name : checkout
        uses : actions/checkout@v2
      
      - name : zip repo
        run : zip -r code.zip .

      - name : test secrets
        run : env

      - name : Veracode Upload And Scan
        uses : veracode/veracode-uploadandscan-action@0.2.1
        with:
          appname: 'Unit21'
          sandboxname: 'Dev'
          createprofile: false
          filepath: 'code.zip'
          vid: ${{ secrets.VERACODE_API_ID }}
          vkey: ${{ secrets.VERACODE_API_KEY }}